(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1e0e1a87"],{2193:function(t,e,i){"use strict";i("536e")},"275f":function(t,e,i){},"2c43":function(t,e,i){},"304f":function(t,e,i){"use strict";i("2c43")},"342f":function(t,e,i){"use strict";i("e206")},"536e":function(t,e,i){},"77a4":function(t,e,i){"use strict";i("275f")},bb45:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t._self._c;return e("Dialog",{staticClass:"indicator-dialog -auto -sticky-footer -mobile-fs",attrs:{mask:!1},on:{clickOutside:t.close},scopedSlots:t._u([{key:"header",fn:function(){return[e("div",[e("div",{staticClass:"title"},[e("div",{on:{dblclick:t.renameIndicator}},[t._v(t._s(t.name))])]),t.description?e("div",{staticClass:"subtitle pl0",domProps:{textContent:t._s(t.description)},on:{dblclick:t.editDescription}}):e("code",{staticClass:"subtitle -filled",domProps:{textContent:t._s(t.indicatorId)},on:{click:t.copyIndicatorId,dblclick:t.editDescription}})]),e("a",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"btn -text -white mlauto -center -no-grab",attrs:{href:"https://github.com/Tucsky/aggr/wiki/introduction-to-scripting",target:"_blank",title:"Scripting documentation"}},[e("i",{staticClass:"icon-info"}),e("span",{staticClass:"ml8"},[t._v("Wiki")])]),t.unsavedChanges?e("button",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"btn ml8 -text -no-grab",attrs:{title:"Rollback changes"},on:{click:t.undoIndicator}},[e("i",{staticClass:"icon-trash"}),e("span",{staticClass:"ml8"},[t._v("Discard")])]):t._e(),e("button",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"btn ml8 -no-grab",class:[!t.unsavedChanges&&"-text",t.unsavedChanges&&"-green"],attrs:{title:"Save changes"},on:{click:t.saveIndicator}},[e("i",{staticClass:"icon-save"}),e("span",{staticClass:"ml8"},[t._v("Save")])])]},proxy:!0}])},[t.error?e("p",{staticClass:"form-feedback ml16"},[e("i",{staticClass:"icon-warning mr4"}),t._v(" "+t._s(t.error)+" ")]):t._e(),e("div",{ref:"containerElement",staticClass:"d-flex indicator-dialog__wrapper"},[e("tabs",{ref:"tabsComponent",staticClass:"indicator-tabs",model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[e("tab",{staticClass:"d-flex p-relative editor",style:{fontSize:t.fontSize+"em"},attrs:{name:"Script"}},[e("prism-editor",{ref:"editor",staticClass:"editor__prism hide-scrollbar",attrs:{value:t.code,highlight:t.highlighter},on:{blur:function(e){return t.updateScript(e.target.value)}}}),e("code-minimap",{ref:"editorMinimap",staticClass:"editor__minimap"}),e("div",{staticClass:"editor__zoom"},[e("div",{staticClass:"btn -text -small",on:{click:function(e){return t.scaleEditor(1.1)}}},[e("i",{staticClass:"icon-plus"})]),e("div",{staticClass:"btn -text -small",on:{click:function(e){return t.scaleEditor(.9)}}},[e("i",{staticClass:"icon-minus"})])]),e("i",{staticClass:"icon-up-thin editor__resize",on:{mousedown:t.handleResize,touchstart:t.handleResize}})],1),e("tab",{staticClass:"indicator-options indicator-options--tab hide-scrollbar",attrs:{name:"Options"}},[t.scriptOptionsKeys.length?e("section",{staticClass:"section"},[t.sections.indexOf("scriptOptions")>-1?e("div",{staticClass:"section__content"},t._l(t.scriptOptionsKeys,(function(i){return e("indicator-option",{key:i,staticClass:"indicator-options__option",attrs:{name:i,"pane-id":t.paneId,"indicator-id":t.indicatorId,"plot-types":t.plotTypes}})})),1):t._e(),e("div",{staticClass:"section__title",on:{click:function(e){return t.toggleSection("scriptOptions",e)}}},[t._v(" Script options "),e("i",{staticClass:"icon-up-thin"})])]):t._e(),t.colorOptionsKeys.length?e("section",{staticClass:"section"},[t.sections.indexOf("colors")>-1?e("div",{staticClass:"section__content"},t._l(t.colorOptionsKeys,(function(i){return e("indicator-option",{key:i,staticClass:"indicator-options__option",attrs:{name:i,"pane-id":t.paneId,"indicator-id":t.indicatorId,"plot-types":t.plotTypes}})})),1):t._e(),e("div",{staticClass:"section__title",on:{click:function(e){return t.toggleSection("colors",e)}}},[t._v(" Colors "),e("i",{staticClass:"icon-up-thin"})])]):t._e(),e("section",{staticClass:"section"},[t.sections.indexOf("defaultOptions")>-1?e("div",{staticClass:"section__content"},t._l(t.defaultOptionsKeys,(function(i){return e("indicator-option",{key:i,staticClass:"indicator-options__option",attrs:{name:i,"pane-id":t.paneId,"indicator-id":t.indicatorId,"plot-types":t.plotTypes}})})),1):t._e(),e("div",{staticClass:"section__title",on:{click:function(e){return t.toggleSection("defaultOptions",e)}}},[t._v(" Other options "),e("i",{staticClass:"icon-up-thin"})])])])],1),e("hr",{staticClass:"-vertical"}),e("div",{staticClass:"indicator-options"},[e("section",{staticClass:"indicator-options__search section"},[e("div",[e("div",{staticClass:"input-group"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.optionsQuery,expression:"optionsQuery"}],staticClass:"form-control",attrs:{type:"text",placeholder:"search..."},domProps:{value:t.optionsQuery},on:{input:function(e){e.target.composing||(t.optionsQuery=e.target.value)}}}),e("button",{staticClass:"btn -text -small",attrs:{type:"button"},on:{click:function(e){t.optionsQuery=""}}},[e("i",{staticClass:"icon-cross"})])]),t._l(t.queryOptionsKeys,(function(i){return e("indicator-option",{key:i,attrs:{name:i,"pane-id":t.paneId,"indicator-id":t.indicatorId,"plot-types":t.plotTypes}})}))],2)]),t.optionsQuery.length?t._e():e("div",{staticClass:"indicator-options__options-scroller hide-scrollbar"},[t.colorOptionsKeys.length?e("section",{staticClass:"section"},[t.sections.indexOf("colors")>-1?e("div",{staticClass:"section__content"},t._l(t.colorOptionsKeys,(function(i){return e("indicator-option",{key:i,attrs:{name:i,"pane-id":t.paneId,"indicator-id":t.indicatorId,"plot-types":t.plotTypes}})})),1):t._e(),e("div",{staticClass:"section__title",on:{click:function(e){return t.toggleSection("colors",e)}}},[t._v(" Colors "),e("i",{staticClass:"icon-up-thin"})])]):t._e(),t.scriptOptionsKeys.length?e("section",{staticClass:"section"},[t.sections.indexOf("scriptOptions")>-1?e("div",{staticClass:"section__content"},t._l(t.scriptOptionsKeys,(function(i){return e("indicator-option",{key:i,attrs:{name:i,"pane-id":t.paneId,"indicator-id":t.indicatorId,"plot-types":t.plotTypes}})})),1):t._e(),e("div",{staticClass:"section__title",on:{click:function(e){return t.toggleSection("scriptOptions",e)}}},[t._v(" Script "),e("i",{staticClass:"icon-up-thin"})])]):t._e(),e("section",{staticClass:"section"},[t.sections.indexOf("defaultOptions")>-1?e("div",{staticClass:"section__content"},t._l(t.defaultOptionsKeys,(function(i){return e("indicator-option",{key:i,attrs:{name:i,"pane-id":t.paneId,"indicator-id":t.indicatorId,"plot-types":t.plotTypes}})})),1):t._e(),e("div",{staticClass:"section__title",on:{click:function(e){return t.toggleSection("defaultOptions",e)}}},[t._v(" Other "),e("i",{staticClass:"icon-up-thin"})])]),e("section",{staticClass:"section"},[t.sections.indexOf("position")>-1?e("div",{staticClass:"section__content"},[e("div",{staticClass:"form-group"},[e("label",[t._v("Scale with "),e("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"icon-info",attrs:{title:t.helps.priceScaleId}})]),e("dropdown-button",{staticClass:"-outline form-control -arrow w-100",attrs:{options:t.availableScales,placeholder:"Default scale"},on:{input:function(e){return t.setPriceScale(e)}},model:{value:t.indicator.options.priceScaleId,callback:function(e){t.$set(t.indicator.options,"priceScaleId",e)},expression:"indicator.options.priceScaleId"}})],1)]):t._e(),e("div",{staticClass:"section__title",on:{click:function(e){return t.toggleSection("position",e)}}},[t._v(" Position in chart "),e("i",{staticClass:"icon-up-thin"})])]),e("section",{staticClass:"section"},[t.sections.indexOf("format")>-1?e("div",{staticClass:"section__content"},[e("div",{staticClass:"d-flex mb4"},[e("small",{staticClass:"mrauto"},[t._v("Format")]),e("small",[t._v("Precision")])]),e("div",{staticClass:"d-flex"},[e("dropdown-button",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"mr8 -outline form-control -arrow",attrs:{value:t.priceFormat,options:["price","volume"],title:"Volume uses abbreviation for Million and Thousand"},on:{input:function(e){return t.setPriceFormat(e,t.precision)}}}),e("editable",{staticClass:"form-control mlauto",attrs:{value:t.precision},on:{input:function(e){return t.setPriceFormat(t.priceFormat,e)}}})],1)]):t._e(),e("div",{staticClass:"section__title",on:{click:function(e){return t.toggleSection("format",e)}}},[t._v(" Price format "),e("i",{staticClass:"icon-up-thin"})])])])])],1),e("footer",[e("presets",{staticClass:"mr8 -left",attrs:{type:"indicator:"+t.indicatorId,adapter:t.getIndicatorPreset,label:"Presets"},on:{apply:function(e){return t.applyIndicatorPreset(e)}}}),e("button",{staticClass:"btn -text -arrow",on:{click:t.toggleIndicatorDropdown}},[t._v(" Options ")]),e("dropdown",{model:{value:t.dropdownIndicatorTrigger,callback:function(e){t.dropdownIndicatorTrigger=e},expression:"dropdownIndicatorTrigger"}},[e("div",{staticClass:"dropdown-item"},[e("label",{staticClass:"checkbox-control -small",on:{mousedown:function(t){t.preventDefault()}}},[e("input",{staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:t.indicator.enabled},on:{change:t.toggleIndicatorAsDefault}}),e("div"),e("span",[t._v("Use as default")])])]),e("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:t.resizeIndicator}},[e("i",{staticClass:"icon-resize-height"}),t._v(" Resize ")]),e("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:t.downloadIndicator}},[e("i",{staticClass:"icon-download"}),t._v(" Download ")]),e("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:t.duplicateIndicator}},[e("i",{staticClass:"icon-copy-paste"}),t._v(" Duplicate ")]),e("div",{staticClass:"dropdown-divider"}),e("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:t.removeIndicator}},[e("i",{staticClass:"icon-cross"}),t._v(" Unload ")])])],1)])},n=[],o=i("e57a"),a=i("1ea0"),r=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"tabs"},[e("div",{staticClass:"tabs__header",attrs:{role:"tablist"}},t._l(t.tabs,(function(i,s){return e(t.useUrlFragment?"a":"button",{key:s,tag:"component",staticClass:"tabs__item tab btn",class:[i.isActive&&"tab--active",i.isDisabled&&"tab--disabled"],attrs:{type:t.useUrlFragment?null:"button",href:t.useUrlFragment?i.hash:null,role:"tab","aria-controls":i.hash,"aria-selected":i.isActive},on:{click:function(e){return t.selectTab(i.hash,e)}}},[e("span",{staticClass:"tab__name"},[t._v(t._s(i.name))]),i.badge?e("span",{staticClass:"badge -compact ml8"},[t._v(t._s(i.badge))]):t._e()])})),1),t._t("default")],2)},c=[],l=i("9ab4"),d=i("60a3");let p=class extends d["c"]{constructor(){super(...arguments),this.tabs=[]}onTabChange(t,e=null){if(null!==t){const e=this.findTab(t);e&&(e.isDisabled||(e.isActive=!0))}if(null!==e){const t=this.findTab(e);t&&(t.isActive=!1)}}created(){this.tabs=this.$children}mounted(){this.selectDefaultTab()}beforeDestroy(){this.unbindHashChange()}bindHashChange(){this.hashChangeHandler||(this.hashChangeHandler=()=>this.selectTab(window.location.hash),window.addEventListener("hashchange",this.hashChangeHandler))}unbindHashChange(){this.hashChangeHandler&&window.addEventListener("hashchange",this.hashChangeHandler)}findTab(t){return"number"===typeof t?this.tabs[t]:this.tabs.find(e=>e.hash===t)}selectDefaultTab(){let t=null;this.useUrlFragment&&(this.bindHashChange(),this.findTab(window.location.hash)&&(t=window.location.hash)),null===t&&null!==this.value&&(t=this.value),null===t&&this.tabs.length&&(t=this.tabs[0].hash),null!==t&&this.onTabChange(t)}selectTab(t,e){e&&!this.useUrlFragment&&e.preventDefault(),this.$emit("input",t)}};Object(l["a"])([Object(d["d"])("value")],p.prototype,"onTabChange",null),p=Object(l["a"])([Object(d["a"])({name:"Tabs",props:{value:{default:null},useUrlFragment:{type:Boolean,default:!1}}})],p);var h=p,u=h,m=(i("2193"),i("2877")),v=Object(m["a"])(u,r,c,!1,null,"ab0d3f84",null),f=v.exports,b=function(){var t=this,e=t._self._c;t._self._setupProxy;return t.isActive?e("div",{staticClass:"tab__content"},[t._t("default")],2):t._e()},g=[],y=i("28f3");let C=class extends d["c"]{constructor(){super(...arguments),this.isActive=!1}get hash(){return this.isDisabled?"#":this.id?"#"+this.id:this.name?"#"+Object(y["x"])(this.name):"#"+this._uid}};C=Object(l["a"])([Object(d["a"])({props:{id:{default:null},name:{required:!0},badge:{type:Number,required:!1,default:null},isDisabled:{default:!1}}})],C);var _=C,I=_,O=Object(m["a"])(I,b,g,!1,null,null,null),S=O.exports,w=i("ecab"),k=i("0c01"),x=i("da81"),T=i.n(x),E=function(){var t=this,e=t._self._c;return e("Dialog",{on:{clickOutside:t.close},scopedSlots:t._u([{key:"header",fn:function(){return[e("div",{staticClass:"title"},[t._v("Configure preset")])]},proxy:!0}])},[e("form",{on:{submit:function(e){return e.preventDefault(),t.submit.apply(null,arguments)}}},[e("div",{staticClass:"form-group mb8"},[e("label",[t._v("Choose what to include in preset")]),e("label",{staticClass:"checkbox-control mt16"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.includeColors,expression:"includeColors"}],staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.includeColors)?t._i(t.includeColors,null)>-1:t.includeColors},on:{change:function(e){var i=t.includeColors,s=e.target,n=!!s.checked;if(Array.isArray(i)){var o=null,a=t._i(i,o);s.checked?a<0&&(t.includeColors=i.concat([o])):a>-1&&(t.includeColors=i.slice(0,a).concat(i.slice(a+1)))}else t.includeColors=n}}}),e("div"),e("span",[t._v("Colors")])])]),e("div",{staticClass:"form-group mb8"},[e("label",{staticClass:"checkbox-control"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.includeValues,expression:"includeValues"}],staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.includeValues)?t._i(t.includeValues,null)>-1:t.includeValues},on:{change:function(e){var i=t.includeValues,s=e.target,n=!!s.checked;if(Array.isArray(i)){var o=null,a=t._i(i,o);s.checked?a<0&&(t.includeValues=i.concat([o])):a>-1&&(t.includeValues=i.slice(0,a).concat(i.slice(a+1)))}else t.includeValues=n}}}),e("div"),e("span",[t._v("Options")])])]),e("div",{staticClass:"form-group mb8"},[e("label",{staticClass:"checkbox-control"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.includeScript,expression:"includeScript"}],staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.includeScript)?t._i(t.includeScript,null)>-1:t.includeScript},on:{change:function(e){var i=t.includeScript,s=e.target,n=!!s.checked;if(Array.isArray(i)){var o=null,a=t._i(i,o);s.checked?a<0&&(t.includeScript=i.concat([o])):a>-1&&(t.includeScript=i.slice(0,a).concat(i.slice(a+1)))}else t.includeScript=n}}}),e("div"),e("span",[t._v("Script")])])]),e("footer",[e("a",{staticClass:"btn -text mr8",attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.close(!1)}}},[t._v("Cancel")]),e("button",{staticClass:"btn -large -green",attrs:{type:"submit"}},[e("i",{staticClass:"icon-check mr8"}),t._v(" Submit ")])])])])},$=[],j={mixins:[a["a"]],data:()=>({includeColors:!0,includeValues:!1,includeScript:!1}),methods:{submit(){this.close({colors:this.includeColors,values:this.includeValues,script:this.includeScript})}}},D=j,P=Object(m["a"])(D,E,$,!1,null,null,null),V=P.exports,z=function(){var t=this,e=t._self._c;t._self._setupProxy;return t.totalHeight>t.visibleHeight?e("div",{staticClass:"code-minimap"},[e("canvas",{ref:"canvas",staticClass:"code-minimap"}),null!==t.visibleHeight?e("div",{staticClass:"code-minimap__bounds",style:{top:t.top+"%",bottom:t.bottom+"%"},on:{mousedown:t.handleMove,touchstart:t.handleMove}}):t._e()]):t._e()},N=[];let A=class extends d["c"]{constructor(){super(...arguments),this.totalHeight=null,this.offsetTop=null,this.visibleHeight=null}get top(){return this.offsetTop/this.totalHeight*100}get bottom(){return(this.totalHeight-(this.offsetTop+this.visibleHeight))/this.totalHeight*100}mounted(){this.$nextTick(()=>{this.bindEditor(),this.updateContent()})}beforeDestroy(){this.editorElement.removeEventListener("scroll",this.handleScroll),this.textareaElement.removeEventListener("blur",this.updateContent)}bindEditor(){this.editorElement=this.$el.previousElementSibling,this.textareaElement=this.editorElement.querySelector("textarea"),this.editorElement.addEventListener("scroll",this.handleScroll),this.textareaElement.addEventListener("blur",this.updateContent)}handleScroll(t){this.offsetTop=t.currentTarget.scrollTop}updateContent(){this.content=this.textareaElement.value.split("\n"),this.updateSize()}updateSize(){this.totalHeight=this.editorElement.scrollHeight,this.visibleHeight=this.editorElement.clientHeight,this.offsetTop=this.editorElement.scrollTop,this.totalHeight<=this.visibleHeight||this.$nextTick(()=>{const t=this.$refs.canvas;t.width=this.$el.clientWidth,t.height=this.$el.parentElement.clientHeight;const e=t.getContext("2d");e.clearRect(0,0,t.width,t.height),this.renderMinimap()})}renderMinimap(){const t=this.$refs.canvas,e=t.getContext("2d");e.fillStyle=getComputedStyle(document.documentElement).getPropertyValue("--theme-color-200"),e.font="monospace";const i=4,s=8,n=t.height/this.content.length;for(let o=0;o<this.content.length;o++)e.fillText(this.content[o].replace(/\b\w+\b/g,String.fromCharCode(8210)).replace(/[^\u2012\s]/g,""),i,s+o*n)}handleMove(t){this.y=Object(y["m"])(t).y,document.addEventListener("mousemove",this.move),document.addEventListener("mouseup",this.release),document.addEventListener("touchmove",this.move),document.addEventListener("touchend",this.release),document.body.classList.add("-unselectable")}move(t){const e=Object(y["m"])(t).y,i=this.y-Object(y["m"])(t).y,s=i/this.$refs.canvas.height;this.editorElement.scrollTop-=s*this.totalHeight,this.y=e}release(){document.removeEventListener("mousemove",this.move),document.removeEventListener("mouseup",this.release),document.removeEventListener("touchmove",this.move),document.removeEventListener("touchend",this.release),document.body.classList.remove("-unselectable"),this.$emit("move",{top:this.top,bottom:this.bottom})}};A=Object(l["a"])([Object(d["a"])({name:"CodeMinimap"})],A);var K=A,L=K,H=(i("77a4"),Object(m["a"])(L,z,N,!1,null,"3f72af57",null)),F=H.exports,R=i("8c7a"),M=(i("cb55"),i("416b"),function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"indicator-option form-group",class:["-"+t.type]},[e("label",[t._v(" "+t._s(t.label)+" ")]),"lineType"===t.name?e("dropdown-button",{staticClass:"-outline form-control -arrow",attrs:{options:{0:"Simple",1:"with steps"},placeholder:"lineType"},on:{input:function(e){return t.setValue(e)}},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}):/linestyle$/i.test(t.name)?e("dropdown-button",{staticClass:"-outline form-control -arrow",attrs:{options:{0:"Solid",1:"Dotted",2:"Dashed",3:"LargeDashed",4:"SparseDotted"},placeholder:"lineStyle"},on:{input:function(e){return t.setValue(e)}},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}):"color"===t.type?e("color-picker-control",{attrs:{label:t.label,model:"rgb","allow-null":"",value:t.value},on:{input:function(e){return t.setValue(e)},close:t.reloadIndicator}}):"string"===t.type||"number"===t.type?e("editable",{staticClass:"form-control",attrs:{value:t.value},on:{input:function(e){return t.setValue(e)}}}):"boolean"===t.type?e("label",{staticClass:"checkbox-control"},[e("input",{staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:t.value},on:{change:function(e){return t.setValue(e.target.checked)}}}),e("span",[t._v(t._s(t.label))]),e("div")]):t._e()],1)}),Q=[],U=i("3918"),q=i("81a6");let G=class extends d["c"]{constructor(){super(...arguments),this.value=null}get currentIndicatorValue(){return this.$store.state[this.paneId].indicators[this.indicatorId].options[this.name]}get label(){return this.name}get type(){let t,e="string";try{t=JSON.parse(this.value)}catch(i){t=this.value}return"boolean"===typeof t||/^(show|toggle|set|use)[A-Z]/.test(this.name)?e="boolean":/color/i.test(this.name)||/^rgba?/.test(t)||/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(t)?e="color":"number"===typeof t&&(e="number"),e}onIndicatorValueChange(){const t=this.getValue();(+this.value!==+t||isNaN(+this.value)&&t!==this.value)&&(this.value=t)}created(){this.value=this.getValue()}getValue(){let t;"undefined"!==typeof this.currentIndicatorValue&&(t=this.currentIndicatorValue);const e=Object(w["g"])(this.name,this.plotTypes);return"undefined"!==typeof t?t&&"object"===typeof t&&e&&"object"===typeof e?Object.assign({},e,t):t:"undefined"!==typeof e?e:null}setValue(t){this.$store.dispatch(this.paneId+"/setIndicatorOption",{id:this.indicatorId,key:this.name,value:t}),this.value=t}reloadIndicator(){this.$store.commit(this.paneId+"/SET_INDICATOR_SCRIPT",{id:this.indicatorId,value:this.$store.state[this.paneId].indicators[this.indicatorId].script})}};Object(l["a"])([Object(d["d"])("currentIndicatorValue")],G.prototype,"onIndicatorValueChange",null),G=Object(l["a"])([Object(d["a"])({name:"IndicatorOption",components:{DropdownButton:U["a"],ColorPickerControl:q["a"]},props:{indicatorId:{type:String,required:!0},paneId:{type:String,required:!0},plotTypes:{required:!0},name:{type:String,required:!0}}})],G);var W=G,B=W,J=(i("342f"),Object(m["a"])(B,M,Q,!1,null,null,null)),Y=J.exports;const Z=["crosshairMarkerVisible","minLength","visible","priceScaleId","priceFormat"];var X={components:{CodeMinimap:F,PrismEditor:o["a"],IndicatorOption:Y,Tabs:f,Tab:S,DropdownButton:U["a"]},props:["paneId","indicatorId"],mixins:[a["a"]],data:()=>({code:"",plotTypes:[],sections:["position","colors"],optionsQuery:"",fontSize:1,tab:0,defaultOptionsKeys:[],scriptOptionsKeys:[],colorOptionsKeys:[],dropdownIndicatorTrigger:null,helps:{priceScaleId:"Use <u>right</u> for binding indicator to main price scale. Otherwise use it as an id to align multiple indicator on same scale (as overlay)",lastValueVisible:"Show last value on right axis",priceLineVisible:"Show horizontal line at current value",borderVisible:"Only for candlestick series, enable borders of candles",lineWidth:"Only for line and area series",lineStyle:"Only for line and area series",lineType:"Only for line and area series"}}),computed:{indicator(){return this.$store.state[this.paneId].indicators[this.indicatorId]},displayName(){return this.indicator.displayName},description(){return this.indicator.description},unsavedChanges(){return this.indicator.unsavedChanges},error(){return this.$store.state[this.paneId].indicatorsErrors[this.indicatorId]},name(){return this.indicator.displayName||this.indicator.name},script(){return this.indicator.script},precision(){return!this.indicator.options.priceFormat||this.indicator.options.priceFormat.auto?"auto":"number"===typeof this.indicator.options.priceFormat.precision?this.indicator.options.priceFormat.precision:2},priceFormat(){return this.indicator.options.priceFormat?this.indicator.options.priceFormat.type:"price"},availableScales(){return Object.values(this.$store.state[this.paneId].indicators).reduce((t,e)=>(e.id!==this.indicatorId&&e.options&&e.options.priceScaleId&&!t[e.options.priceScaleId]&&(t[e.options.priceScaleId]=e.name||e.id),t),{[this.indicatorId]:"Own scale",right:"Right scale (main)"})},queryOptionsKeys(){if(!this.optionsQuery.length)return[];const t=new RegExp(this.optionsQuery,"i");return[...this.scriptOptionsKeys,...this.defaultOptionsKeys,...this.colorOptionsKeys].filter(e=>t.test(e))}},watch:{script:{handler(t){this.code=t},immediate:!0}},created(){this.restoreNavigationState(),this.$nextTick(()=>{this.getPlotTypes(),this.getOptionsKeys()})},beforeDestroy(){this.saveNavigationState()},methods:{restoreNavigationState(){this.indicator.navigationState&&(this.sections=this.indicator.navigationState.sections.slice(),this.tab=this.indicator.navigationState.tab,this.optionsQuery=this.indicator.navigationState.optionsQuery,this.fontSize=this.indicator.navigationState.fontSize)},saveNavigationState(){this.$store.dispatch(this.paneId+"/setIndicatorNavigationState",{id:this.indicatorId,navigationState:{sections:this.sections,tab:this.tab,optionsQuery:this.optionsQuery,fontSize:this.fontSize}})},setPriceScale(t){this.$store.dispatch(this.paneId+"/setIndicatorOption",{id:this.indicatorId,key:"priceScaleId",value:t})},updateScript(t){t=t.trim(),this.$store.commit(this.paneId+"/SET_INDICATOR_SCRIPT",{id:this.indicatorId,value:t}),this.getPlotTypes(),this.getOptionsKeys()},getScriptOptions(t){const e=[],i=/options\.([a-zA-Z0-9_]+)/g;let s;do{(s=i.exec(t))&&e.push(s[1])}while(s);return e},getPlotTypes(){const t=Object.keys(w["b"]).map(t=>t.replace(/[^\w]/g,""));this.plotTypes=(this.script.match(new RegExp(`(?:\\n|\\s|^)(?:plot)?(${t.join("|")})\\(`,"g"))||[]).map(t=>{const e=t.replace(/[^\w]/g,"").replace(/^plot/,"");return w["i"][e]||e}).filter((t,e,i)=>i.indexOf(t)===e&&w["b"][t])},async removeIndicator(){await this.close(),this.$store.dispatch(this.paneId+"/removeIndicator",{id:this.indicatorId})},async resizeIndicator(){await this.close(),this.$store.commit(this.paneId+"/TOGGLE_LAYOUTING",this.indicatorId)},async renameIndicator(){const t=await k["a"].prompt({action:"Rename",input:this.$store.state[this.paneId].indicators[this.indicatorId].name});t&&t!==this.name&&(await this.close(),await this.$store.dispatch(this.paneId+"/renameIndicator",{id:this.indicatorId,name:t}))},async editDescription(){const t=await k["a"].prompt({action:"Description",input:this.description});null!==t&&t!==this.description&&await this.$store.commit(this.paneId+"/UPDATE_DESCRIPTION",{id:this.indicatorId,description:t})},async downloadIndicator(){this.$store.dispatch(this.paneId+"/downloadIndicator",this.indicatorId)},async duplicateIndicator(){this.$store.dispatch(this.paneId+"/duplicateIndicator",this.indicatorId),await this.close(),k["a"].openIndicator(this.paneId,this.indicatorId)},async saveIndicator(){this.$store.dispatch(this.paneId+"/saveIndicator",this.indicatorId)},async undoIndicator(){await k["a"].confirm("Undo changes ?")&&(this.$store.dispatch(this.paneId+"/undoIndicator",this.indicatorId),this.$refs.editorMinimap.updateSize())},toggleSection(t,e){const i=this.sections.indexOf(t);-1===i?this.sections.push(t):this.sections.splice(i,1),this.$nextTick(()=>{const t=e.target.parentElement;t&&t.scrollIntoView&&t.scrollIntoView()})},async getIndicatorPreset(){const t=await k["a"].openAsPromise(V);if(t){if(!t.colors&&!t.script&&!t.values)return void this.$store.dispatch("app/showNotice",{title:"You did not select anything to save in the preset !",type:"error"});const e={options:{}};if(t.values){for(const t of this.scriptOptionsKeys)e.options[t]=Object(w["h"])(this.paneId,this.indicatorId,t,this.plotTypes);for(const t of this.defaultOptionsKeys)e.options[t]=Object(w["h"])(this.paneId,this.indicatorId,t,this.plotTypes)}if(t.colors)for(const t of this.colorOptionsKeys)e.options[t]=Object(w["h"])(this.paneId,this.indicatorId,t,this.plotTypes);return t.script&&(e.script=this.script),e}},getOptionsKeys(){const t=Object.keys(w["c"]),e=this.plotTypes.reduce((t,e)=>[...t,...Object.keys(w["b"][e]||{})],[]),i=this.getScriptOptions(this.script),s=[...t,...e,...i].filter((t,e,i)=>-1===Z.indexOf(t)&&i.indexOf(t)==e);this.scriptOptionsKeys=s.filter(t=>!/color/i.test(t)&&-1!==i.indexOf(t)).sort((t,e)=>t>e?1:t<e?-1:0),this.defaultOptionsKeys=s.filter(t=>!/color/i.test(t)&&-1===i.indexOf(t)).sort((t,e)=>t>e?1:t<e?-1:0),this.colorOptionsKeys=s.filter(t=>/color/i.test(t))},applyIndicatorPreset(t){const e=this.$store.state[this.paneId].indicators[this.indicatorId];if(t)T()(e,t);else{const t=this.scriptOptionsKeys.concat(this.defaultOptionsKeys,this.colorOptionsKeys);for(const i of t){const t=this.getDefaultValue(i);"undefined"!==typeof t&&(e.options[i]=t)}}this.otherOptionsKeys=this.colorOptionsKeys=[],this.$nextTick(()=>{this.$store.commit(this.paneId+"/SET_INDICATOR_SCRIPT",{id:this.indicatorId}),this.getPlotTypes(),this.getOptionsKeys(),this.$store.commit(this.paneId+"/FLAG_INDICATOR_AS_UNSAVED",this.indicatorId)})},async toggleIndicatorAsDefault(){if(!this.unsavedChanges||await k["a"].confirm("Indicator has unsaved changes, save it and turn "+(this.indicator.enabled?"off":"on")+" default ?"))return this.indicator.enabled=!this.indicator.enabled,this.saveIndicator()},highlighter(t){return Object(R["highlight"])(t,R["languages"].js,"js")},handleResize(t){this._resizeOrigin=Object(y["m"])(t),this.$refs.tabsComponent.$el.style.width=this.$refs.tabsComponent.$el.clientWidth+"px",this.$refs.containerElement.style.height=this.$refs.containerElement.clientHeight+"px",document.addEventListener("mousemove",this.resize),document.addEventListener("mouseup",this.release),document.addEventListener("touchmove",this.resize),document.addEventListener("touchend",this.release),document.body.classList.add("-unselectable")},resize(t){const e=Object(y["m"])(t),i=parseInt(this.$refs.tabsComponent.$el.style.width)+2*(e.x-this._resizeOrigin.x),s=parseInt(this.$refs.containerElement.style.height)+2*(e.y-this._resizeOrigin.y);this.$refs.tabsComponent.$el.style.width=i+"px",this.$refs.containerElement.style.height=s+"px",this._resizeOrigin=e},release(){document.removeEventListener("mousemove",this.resize),document.removeEventListener("mouseup",this.release),document.removeEventListener("touchmove",this.resize),document.removeEventListener("touchend",this.release),document.body.classList.remove("-unselectable"),this.$refs.editor.setLineNumbersHeight(),setTimeout(()=>{this.$refs.editorMinimap.updateSize()})},scaleEditor(t){isNaN(this.fontSize)&&(this.fontSize=1),this.fontSize*=t,setTimeout(()=>{this.$refs.editorMinimap.updateSize()})},setPriceFormat(t,e){let i=!1,s=Math.round(e);(""===e||isNaN(s))&&(i=!0,s=2),this.$store.dispatch(this.paneId+"/setIndicatorOption",{id:this.indicatorId,key:"priceFormat",value:{type:t,precision:s,minMove:1/Math.pow(10,s),auto:i}})},copyIndicatorId(){Object(y["d"])(this.indicatorId),this.$store.dispatch("app/showNotice",{title:"Copied indicator id to clipboard"})},toggleIndicatorDropdown(t){this.dropdownIndicatorTrigger?this.dropdownIndicatorTrigger=null:this.dropdownIndicatorTrigger=t.currentTarget}}},tt=X,et=(i("304f"),Object(m["a"])(tt,s,n,!1,null,"5533d3f2",null));e["default"]=et.exports},e206:function(t,e,i){}}]);
//# sourceMappingURL=chunk-1e0e1a87.d0da451f.js.map