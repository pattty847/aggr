{"version":3,"sources":["webpack:///./src/mixins/paneMixin.ts","webpack:///./src/components/stats/Stats.vue?8541","webpack:///./src/components/panes/PaneHeader.vue?8308","webpack:///./src/components/panes/PaneHeader.vue","webpack:///./src/components/panes/PaneHeader.vue?260b","webpack:///./src/components/panes/PaneHeader.vue?7137","webpack:///./src/components/stats/Stats.vue?d181","webpack:///./src/utils/bucket.ts","webpack:///./src/components/stats/Stats.vue","webpack:///./src/components/stats/Stats.vue?c0cb","webpack:///./src/components/stats/Stats.vue?b009"],"names":["PaneMixin","this","$store","state","panes","paneId","$el","id","refreshZoom","$nextTick","width","clientWidth","onResize","clientHeight","addEventListener","focusPane","removeEventListener","_onStoreMutation","dispatch","commit","props","required","type","String","render","_vm","_h","$createElement","_c","_self","staticClass","class","loading","attrs","on","renamePane","_v","_s","name","maximizePane","_t","openSearch","openSettings","_e","toggleDropdown","model","value","callback","$$v","paneDropdownTrigger","expression","$event","stopPropagation","changeZoom","resetZoom","apply","arguments","zoom","toFixed","settings","duplicatePane","removePane","staticRenderFns","market","marketsListeners","markets","local","event","direction","shiftKey","$emit","async","dialogService","confirm","parentElement","classList","currentTarget","target","className","el","isMaximized","toggle","siblings","sibling","getAttribute","remove","style","display","cls","Event","window","dispatchEvent","prompt","action","input","open","default","Function","Boolean","component","_l","bucket","key","editStat","ref","options","stacks","filled","remaining","timeouts","adapter","getAdapter","isNaN","store","precision","color","parseColor","granularity","Math","max","windowLabel","replace","clear","str","litteral","live","i","length","clearTimeout","stats","timestamp","appendStack","p","ceil","change","addData","Date","now","push","setTimeout","shiftStack","bind","shift","stack","data","chart","serie","apiMethodName","charAt","toUpperCase","slice","Object","assign","priceScaleId","title","priceLineVisible","lineWidth","scaleMargins","top","bottom","getColorOptions","getValue","point","time","update","r","g","b","indexOf","topColor","bottomColor","lineColor","colorInput","test","applyOptions","removeSeries","_buckets","_feed","enableChart","buckets","subscribe","mutation","_chart","payload","prepareBuckets","recolorBucket","reloadBucketSerie","createChart","removeChart","createBucket","removeBucket","refreshBucket","refreshBucketName","aggregatorService","off","onVolume","clearBuckets","chartOptions","$refs","createSerie","refreshChartDimensions","removeIndicator","debounceTime","_refreshChartDimensionsTimeout","resize","pane","sums","onStats","$set","updateSerie","unbind","$delete","updateColor","statBucket","enabled","StatDialog","bucketId","components","PaneHeader"],"mappings":"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","file":"js/chunk-187d1773.22e7e72d.js","sourcesContent":["import { Pane } from '@/store/panes'\nimport Vue from 'vue'\nimport Component from 'vue-class-component'\n\n@Component({\n  props: {\n    paneId: {\n      required: true,\n      type: String\n    }\n  }\n})\nexport default class PaneMixin extends Vue {\n  paneId: string\n  protected _onStoreMutation: () => void\n\n  get pane(): Pane {\n    return this.$store.state.panes.panes[this.paneId]\n  }\n\n  mounted() {\n    this.$el.id = this.paneId\n\n    this.refreshZoom()\n\n    this.$nextTick(() => {\n      const width = this.$el.clientWidth\n\n      if (typeof this.onResize === 'function') {\n        this.onResize(width, this.$el.clientHeight, true)\n      }\n    })\n\n    this.$el.addEventListener('mousedown', this.focusPane)\n  }\n\n  beforeDestroy() {\n    this.$el.removeEventListener('mousedown', this.focusPane)\n\n    if (this._onStoreMutation) {\n      this._onStoreMutation()\n    }\n  }\n\n  refreshZoom() {\n    this.$store.dispatch('panes/refreshZoom', this.paneId)\n  }\n\n  focusPane() {\n    this.$store.commit('app/SET_FOCUSED_PANE', this.paneId)\n  }\n\n  onResize?(newWidth: number, newHeight: number, isMounting?: boolean)\n}\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Stats.vue?vue&type=style&index=0&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"pane-header hide-scrollbar pane-overlay d-flex\",class:{ '-loading': _vm.loading }},[_c('div',{staticClass:\"pane-header__loader\"}),_c('span',{staticClass:\"pane-header__name ml4 mrauto\",attrs:{\"data-hide-header\":\"\"},on:{\"dblclick\":_vm.renamePane}},[_vm._v(_vm._s(_vm.name))]),_c('div',{staticClass:\"toolbar flex-grow-1\",on:{\"dblclick\":_vm.maximizePane}},[_vm._t(\"default\"),_c('button',{staticClass:\"toolbar__label min-768\",attrs:{\"type\":\"button\"},on:{\"click\":_vm.openSearch}},[_c('i',{staticClass:\"icon-search\"})]),(_vm.settings)?_c('button',{staticClass:\"toolbar__label min-768\",attrs:{\"type\":\"button\"},on:{\"click\":_vm.openSettings}},[_c('i',{staticClass:\"icon-cog\"})]):_vm._e(),_c('button',{staticClass:\"toolbar__label\",attrs:{\"type\":\"button\"},on:{\"click\":_vm.toggleDropdown}},[_c('i',{staticClass:\"icon-more\"})]),_c('dropdown',{model:{value:(_vm.paneDropdownTrigger),callback:function ($$v) {_vm.paneDropdownTrigger=$$v},expression:\"paneDropdownTrigger\"}},[_c('div',{staticClass:\"d-flex btn-group\"},[_c('button',{staticClass:\"btn -green\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){$event.stopPropagation();return _vm.changeZoom($event, -1)}}},[_c('i',{staticClass:\"icon-minus\"})]),_c('button',{staticClass:\"btn -green text-monospace flex-grow-1 text-center\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){$event.stopPropagation();return _vm.resetZoom.apply(null, arguments)}}},[_vm._v(\" Ã— \"+_vm._s(_vm.zoom.toFixed(2))+\" \")]),_c('button',{staticClass:\"btn -green\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){$event.stopPropagation();return _vm.changeZoom($event, 1)}}},[_c('i',{staticClass:\"icon-plus\"})])]),_vm._t(\"menu\"),(_vm.settings !== null)?_c('button',{staticClass:\"dropdown-item\",attrs:{\"type\":\"button\"},on:{\"click\":_vm.openSettings}},[_c('i',{staticClass:\"icon-cog\"}),_c('span',[_vm._v(\"Settings\")])]):_vm._e(),_c('button',{staticClass:\"dropdown-item\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){return _vm.$store.dispatch('app/showSearch', _vm.paneId)}}},[_c('i',{staticClass:\"icon-search\"}),_c('span',[_vm._v(\"Sources\")])]),_c('button',{staticClass:\"dropdown-item\",attrs:{\"type\":\"button\"},on:{\"click\":_vm.maximizePane}},[_c('i',{staticClass:\"icon-enlarge\"}),_c('span',[_vm._v(\"Maximize\")])]),_c('button',{staticClass:\"dropdown-item\",attrs:{\"type\":\"button\"},on:{\"click\":_vm.duplicatePane}},[_c('i',{staticClass:\"icon-copy-paste\"}),_c('span',[_vm._v(\"Duplicate\")])]),_c('div',{staticClass:\"dropdown--divider\"}),_c('button',{staticClass:\"dropdown-item\",attrs:{\"type\":\"button\"},on:{\"click\":_vm.removePane}},[_c('i',{staticClass:\"icon-trash\"}),_c('span',[_vm._v(\"Remove\")])])],2)],2)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from 'vue'\nimport Component from 'vue-class-component'\n\nimport { getSiblings } from '@/utils/helpers'\nimport dialogService from '@/services/dialogService'\n\n@Component({\n  name: 'PaneHeader',\n  props: {\n    paneId: {\n      type: String\n    },\n    settings: {\n      type: Function,\n      default: null\n    },\n    loading: {\n      type: Boolean,\n      default: false\n    }\n  }\n})\nexport default class extends Vue {\n  private settings?: () => Promise<any>\n  paneId: string\n  paneDropdownTrigger = null\n\n  get zoom() {\n    return this.$store.state.panes.panes[this.paneId].zoom || 1\n  }\n\n  get type() {\n    return this.$store.state.panes.panes[this.paneId].type\n  }\n\n  get name() {\n    const name = this.$store.state.panes.panes[this.paneId].name\n    const market = this.$store.state.panes.marketsListeners[\n      this.$store.state.panes.panes[this.paneId].markets[0]\n    ]\n\n    if (name) {\n      return name\n    } else if (market) {\n      return market.local\n    } else {\n      return this.type\n    }\n  }\n\n  openSearch() {\n    this.$store.dispatch('app/showSearch', this.paneId)\n  }\n\n  changeZoom(event, direction) {\n    const zoom = this.zoom + (event.shiftKey ? 0.0625 : 0.125) * direction\n    this.$store.dispatch('panes/setZoom', { id: this.paneId, zoom: zoom })\n\n    this.$emit('zoom', zoom)\n  }\n\n  resetZoom() {\n    this.$store.dispatch('panes/setZoom', { id: this.paneId, zoom: 1 })\n\n    this.$emit('zoom', 1)\n  }\n\n  async removePane() {\n    if (await dialogService.confirm(`Delete pane \"${this.paneId}\" ?`)) {\n      this.$store.dispatch('panes/removePane', this.paneId)\n    }\n  }\n\n  duplicatePane() {\n    this.$store.dispatch('panes/duplicatePane', this.paneId)\n  }\n\n  highlightPane(value: boolean) {\n    this.$el.parentElement.parentElement.classList[value ? 'add' : 'remove'](\n      '-highlight'\n    )\n  }\n\n  maximizePane(event) {\n    if (\n      event.type === 'dblclick' &&\n      event.currentTarget !== event.target &&\n      event.target.className !== 'toolbar__spacer'\n    ) {\n      return\n    }\n\n    const el = this.$el.parentElement.parentElement\n    const isMaximized = el.classList.toggle('-maximized')\n\n    const siblings = getSiblings(el)\n\n    for (const sibling of siblings) {\n      if (!sibling.getAttribute('type')) {\n        continue\n      }\n      sibling.classList.remove('-maximized')\n      sibling.style.display = isMaximized ? 'none' : 'block'\n    }\n\n    const cls = Event as any\n\n    window.dispatchEvent(new cls('resize'))\n  }\n\n  async renamePane() {\n    const name = await dialogService.prompt({\n      action: 'Rename',\n      input: this.name\n    })\n\n    if (name !== this.name) {\n      this.$store.commit('panes/SET_PANE_NAME', { id: this.paneId, name: name })\n    }\n  }\n\n  toggleDropdown(event) {\n    if (this.paneDropdownTrigger) {\n      this.paneDropdownTrigger = null\n    } else {\n      this.paneDropdownTrigger = event.currentTarget\n    }\n  }\n\n  async openSettings() {\n    if (!this.settings) {\n      return\n    }\n\n    dialogService.open((await this.settings()).default, {\n      paneId: this.paneId\n    })\n  }\n}\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--14-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PaneHeader.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--14-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PaneHeader.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./PaneHeader.vue?vue&type=template&id=219eac84&\"\nimport script from \"./PaneHeader.vue?vue&type=script&lang=ts&\"\nexport * from \"./PaneHeader.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"pane-stats\"},[_c('pane-header',{attrs:{\"paneId\":_vm.paneId,\"settings\":function () { return import('@/components/stats/StatsDialog.vue'); }}}),_c('ul',{staticClass:\"stats-buckets\"},_vm._l((_vm.data),function(bucket,id){return _c('li',{key:id,staticClass:\"stat-bucket\",on:{\"click\":function($event){return _vm.editStat(id)}}},[_c('div',{staticClass:\"stat-bucket__name\"},[_vm._v(_vm._s(bucket.name))]),_c('div',{staticClass:\"stat-bucket__value\"},[_vm._v(_vm._s(bucket.value))])])}),0),(_vm.enableChart)?_c('div',{ref:\"chart\",staticClass:\"stats-chart\"}):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { defaultPlotsOptions } from '@/components/chart/options'\nimport { Volumes } from '@/types/types'\nimport { IChartApi, ISeriesApi, UTCTimestamp } from 'lightweight-charts'\nimport store from '../store'\nimport { hexToRgb, splitColorCode } from './colors'\nimport { getHms } from './helpers'\n\nexport type BucketColor = string | ((value: number) => string)\n\nexport interface BucketOptions {\n  id: string\n  name: string\n  window?: number\n  precision?: number\n  color?: string\n  type?: string\n}\n\nexport default class Bucket {\n  id: string\n  name: string\n  window: number\n  precision: number\n  color: BucketColor\n  granularity: number\n  type: string\n\n  stacks: any[] = []\n\n  private timestamp: number\n  private live: number\n  private filled = false\n  private remaining = 0\n\n  private adapter: (stats: Volumes) => number\n  private serie: ISeriesApi<'Line'>\n  private timeouts: number[] = []\n\n  constructor(input, options: BucketOptions, paneId: string) {\n    this.id = options.id\n    this.name = options.name\n\n    this.adapter = this.getAdapter(input)\n\n    this.window =\n      (!isNaN(options.window) ? +options.window : store.state[paneId].window) ||\n      60000\n    this.precision = options.precision\n    this.color = this.parseColor(options.color)\n    this.granularity = Math.max(\n      store.state[paneId].granularity,\n      this.window / 5000\n    )\n    this.type = options.type || 'line'\n\n    const windowLabel = getHms(this.window).replace(/^1(\\w)$/, '$1')\n\n    this.name += '/' + windowLabel\n\n    this.clear()\n\n    if (module.hot) {\n      module.hot.dispose(() => {\n        this.unbind()\n      })\n    }\n  }\n\n  getAdapter(str: string) {\n    const litteral = str.replace(\n      /([^.]|^)(vbuy|vsell|cbuy|csell|lbuy|lsell)/g,\n      '$1stats.$2'\n    )\n    return new Function('stats', `'use strict'; return ${litteral};`) as (\n      stats: Volumes\n    ) => number\n  }\n\n  clear() {\n    this.stacks = []\n    this.live = 0\n    this.filled = false\n    this.remaining = 0\n\n    for (let i = 0; i < this.timeouts.length; i++) {\n      clearTimeout(this.timeouts[i])\n    }\n\n    this.timeouts = []\n  }\n\n  unbind() {\n    this.clear()\n  }\n\n  onStats(stats: Volumes) {\n    const value = this.adapter(stats)\n\n    if (\n      !this.stacks.length ||\n      stats.timestamp > this.timestamp + this.granularity\n    ) {\n      this.appendStack(stats.timestamp)\n    } else if (this.filled && this.remaining) {\n      const p = (stats.timestamp - this.timestamp) / this.granularity\n      const remaining = Math.ceil(this.stacks[0] * (1 - p))\n      const change = this.remaining - remaining\n      this.remaining = remaining\n      this.live -= change\n    }\n\n    this.addData(value)\n  }\n\n  appendStack(timestamp) {\n    if (!timestamp) {\n      timestamp = Date.now()\n    }\n\n    if (!this.stacks.length || this.stacks[this.stacks.length - 1]) {\n      this.stacks.push(0)\n\n      this.timeouts.push(setTimeout(this.shiftStack.bind(this), this.window))\n    }\n\n    this.timestamp = timestamp\n\n    if (!this.filled && this.stacks.length === this.window / this.granularity) {\n      this.filled = true\n    }\n  }\n\n  shiftStack() {\n    this.timeouts.shift()\n\n    const stack = this.stacks.shift()\n\n    if (!stack) {\n      return\n    }\n\n    if (this.remaining) {\n      this.live -= this.remaining\n    }\n\n    this.remaining = this.stacks[0]\n\n    // this.live -= stack\n  }\n\n  addData(data) {\n    this.stacks[this.stacks.length - 1] += data\n    this.live += data\n  }\n\n  getValue() {\n    return this.live\n  }\n\n  createSerie(chart: IChartApi) {\n    if (this.serie) {\n      return\n    }\n\n    const apiMethodName =\n      'add' +\n      (this.type.charAt(0).toUpperCase() + this.type.slice(1)) +\n      'Series'\n    const options = Object.assign({}, defaultPlotsOptions[this.type], {\n      priceScaleId: this.name,\n      title: this.name,\n      priceLineVisible: false,\n      lineWidth: 1,\n      scaleMargins: {\n        top: 0.05,\n        bottom: 0.05\n      },\n      ...this.getColorOptions()\n    })\n\n    this.serie = chart[apiMethodName](options)\n  }\n\n  updateSerie() {\n    const value = this.getValue()\n\n    if (\n      !this.serie ||\n      !this.timestamp ||\n      (this.type === 'histogram' && !value)\n    ) {\n      return\n    }\n\n    const point: any = {\n      time: (this.timestamp / 1000) as UTCTimestamp,\n      value: value\n    }\n\n    if (typeof this.color === 'function') {\n      point.color = this.color(value)\n    }\n\n    this.serie.update(point)\n  }\n\n  getColorOptions() {\n    if (typeof this.color === 'function') {\n      return {}\n    }\n\n    if (this.type === 'area') {\n      let r: number\n      let g: number\n      let b: number\n\n      if ((this.color as string).indexOf('#') === 0) {\n        ;[r, g, b] = hexToRgb(this.color)\n      } else {\n        ;[r, g, b] = splitColorCode(this.color)\n      }\n\n      const topColor = `rgba(${r},${g},${b}, .4)`\n      const bottomColor = `rgba(${r},${g},${b}, 0)`\n      return {\n        topColor,\n        bottomColor,\n        lineColor: this.color\n      }\n    } else {\n      return { color: this.color }\n    }\n  }\n\n  parseColor(colorInput: string): BucketColor {\n    if (/rgba?\\(|#/.test(colorInput)) {\n      return colorInput\n    }\n\n    return (function() {\n      'use strict'\n      return new Function('value', '\"use strict\"; return ' + colorInput)\n    })() as BucketColor\n  }\n\n  updateColor(color) {\n    if (!this.serie) {\n      return\n    }\n\n    this.color = this.parseColor(color)\n\n    if (typeof color === 'string') {\n      this.serie.applyOptions(this.getColorOptions())\n    }\n  }\n\n  removeIndicator(chart: IChartApi) {\n    if (!this.serie) {\n      return\n    }\n\n    chart.removeSeries(this.serie)\n\n    delete this.serie\n  }\n}\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Mixins } from 'vue-property-decorator'\r\nimport * as TV from 'lightweight-charts'\r\nimport aggregatorService from '@/services/aggregatorService'\r\nimport Bucket from '../../utils/bucket'\r\nimport {\r\n  defaultStatsChartOptions,\r\n  getChartOptions,\r\n  getChartCustomColorsOptions\r\n} from '../chart/options'\r\n\r\nimport StatDialog from './StatDialog.vue'\r\nimport dialogService from '@/services/dialogService'\r\n\r\nimport { getBucketId } from '@/utils/helpers'\r\nimport { formatAmount } from '@/services/productsService'\r\nimport PaneMixin from '@/mixins/paneMixin'\r\nimport PaneHeader from '../panes/PaneHeader.vue'\r\n\r\n@Component({\r\n  components: { PaneHeader },\r\n  name: 'Stats'\r\n})\r\nexport default class extends Mixins(PaneMixin) {\r\n  data = {}\r\n\r\n  $refs!: {\r\n    chart: HTMLElement\r\n  }\r\n\r\n  private _refreshChartDimensionsTimeout: number\r\n  private _chart: TV.IChartApi\r\n  private _buckets: { [id: string]: Bucket } = {}\r\n  private _feed: string = null\r\n\r\n  get enableChart() {\r\n    return this.$store.state[this.paneId].enableChart\r\n  }\r\n\r\n  get buckets() {\r\n    return this.$store.state[this.paneId].buckets\r\n  }\r\n\r\n  created() {\r\n    this._onStoreMutation = this.$store.subscribe(mutation => {\r\n      switch (mutation.type) {\r\n        case 'settings/SET_TEXT_COLOR':\r\n          if (this._chart && mutation.payload) {\r\n            this._chart.applyOptions(\r\n              getChartCustomColorsOptions(mutation.payload)\r\n            )\r\n          }\r\n          break\r\n        case 'settings/SET_CHART_THEME':\r\n          if (this._chart) {\r\n            this._chart.applyOptions(getChartCustomColorsOptions())\r\n          }\r\n          break\r\n        case 'panes/SET_PANE_MARKETS':\r\n        case this.paneId + '/SET_WINDOW':\r\n          if (mutation.payload.id && mutation.payload.id !== this.paneId) {\r\n            break\r\n          }\r\n          this.prepareBuckets()\r\n          break\r\n        case this.paneId + '/SET_BUCKET_COLOR':\r\n          this.recolorBucket(mutation.payload.id, mutation.payload.value)\r\n          break\r\n        case this.paneId + '/SET_BUCKET_TYPE':\r\n          if (this._chart) {\r\n            this.reloadBucketSerie(mutation.payload.id, mutation.payload.value)\r\n          }\r\n          break\r\n        case this.paneId + '/TOGGLE_CHART':\r\n          if (mutation.payload) {\r\n            this.createChart()\r\n          } else {\r\n            this.removeChart()\r\n          }\r\n          break\r\n        case this.paneId + '/TOGGLE_BUCKET':\r\n          if (mutation.payload.value) {\r\n            this.createBucket(this.buckets[mutation.payload.id])\r\n          } else {\r\n            this.removeBucket(mutation.payload.id)\r\n          }\r\n          break\r\n        case this.paneId + '/REMOVE_BUCKET':\r\n          this.removeBucket(mutation.payload)\r\n          break\r\n        case this.paneId + '/SET_BUCKET_WINDOW':\r\n        case this.paneId + '/SET_BUCKET_INPUT':\r\n        case this.paneId + '/SET_BUCKET_PRECISION':\r\n          this.refreshBucket(mutation.payload.id)\r\n          break\r\n        case this.paneId + '/RENAME_BUCKET':\r\n          this.refreshBucketName(mutation.payload)\r\n          break\r\n      }\r\n    })\r\n\r\n    this.prepareBuckets()\r\n  }\r\n\r\n  mounted() {\r\n    if (this.enableChart) {\r\n      this.createChart()\r\n    }\r\n  }\r\n\r\n  beforeDestroy() {\r\n    if (this._feed) {\r\n      aggregatorService.off(this._feed, this.onVolume)\r\n    }\r\n\r\n    this.clearBuckets()\r\n    this.removeChart()\r\n\r\n    this._chart = null\r\n  }\r\n\r\n  async createChart() {\r\n    await this.$nextTick()\r\n\r\n    const chartOptions = getChartOptions(defaultStatsChartOptions as any)\r\n\r\n    this._chart = TV.createChart(this.$refs.chart, chartOptions)\r\n\r\n    for (const id in this._buckets) {\r\n      this._buckets[id].createSerie(this._chart)\r\n    }\r\n\r\n    this.refreshChartDimensions(0)\r\n  }\r\n\r\n  removeChart() {\r\n    if (!this._chart) {\r\n      return\r\n    }\r\n\r\n    // this.stopChartUpdate()\r\n\r\n    for (const id in this._buckets) {\r\n      this._buckets[id].removeIndicator(this._chart)\r\n    }\r\n\r\n    this._chart.remove()\r\n\r\n    this._chart = null\r\n  }\r\n\r\n  /* chartUpdate() {\r\n    if (!this._chartUpdateInterval) {\r\n      this._chartUpdateInterval = setInterval(this.chartUpdate.bind(this), 100)\r\n      return\r\n    }\r\n\r\n    for (const id in this._buckets) {\r\n      this._buckets[id].updateSerie()\r\n    }\r\n  }\r\n  stopChartUpdate() {\r\n    if (this._chartUpdateInterval) {\r\n      clearInterval(this._chartUpdateInterval)\r\n      delete this._chartUpdateInterval\r\n    }\r\n  } */\r\n  async refreshChartDimensions(debounceTime = 500) {\r\n    if (!this.enableChart) {\r\n      return\r\n    }\r\n\r\n    clearTimeout(this._refreshChartDimensionsTimeout)\r\n\r\n    this._refreshChartDimensionsTimeout = setTimeout(() => {\r\n      this._chart &&\r\n        this._chart.resize(this.$el.clientWidth, this.$el.clientHeight)\r\n    }, debounceTime)\r\n  }\r\n  prepareBuckets() {\r\n    if (this._feed) {\r\n      console.log(`[stats/${this.paneId}] unsubscribe from feed`, this._feed)\r\n      aggregatorService.off(this._feed, this.onVolume)\r\n    }\r\n\r\n    this.clearBuckets()\r\n\r\n    for (const id in this.buckets) {\r\n      this.createBucket(this.buckets[id])\r\n    }\r\n\r\n    this._feed = 'bucket-' + getBucketId(this.pane.markets)\r\n    console.log(`[stats/${this.paneId}] subscribe to feed`, this._feed)\r\n\r\n    if (this._feed.length) {\r\n      aggregatorService.on(this._feed, this.onVolume)\r\n    } else {\r\n      console.log(`[stats/${this.paneId}] error feed empty...`)\r\n    }\r\n  }\r\n  onVolume(sums) {\r\n    for (const id in this._buckets) {\r\n      this._buckets[id].onStats(sums)\r\n\r\n      if (this._buckets[id].stacks.length) {\r\n        const value = this._buckets[id].getValue()\r\n\r\n        this.$set(\r\n          this.data[id],\r\n          'value',\r\n          formatAmount(value, this._buckets[id].precision)\r\n        )\r\n      }\r\n\r\n      if (this._chart) {\r\n        this._buckets[id].updateSerie()\r\n      }\r\n    }\r\n  }\r\n\r\n  clearBuckets() {\r\n    for (const id in this._buckets) {\r\n      this.removeBucket(id)\r\n    }\r\n\r\n    this._buckets = {}\r\n  }\r\n\r\n  removeBucket(id) {\r\n    if (!this._buckets[id]) {\r\n      return\r\n    }\r\n\r\n    this._buckets[id].unbind()\r\n\r\n    if (this._chart) {\r\n      this._buckets[id].removeIndicator(this._chart)\r\n    }\r\n\r\n    this.$delete(this.data, id)\r\n\r\n    delete this._buckets[id]\r\n  }\r\n  refreshBucket(id) {\r\n    const options = this.buckets[id]\r\n\r\n    if (!options) {\r\n      return\r\n    }\r\n\r\n    this.removeBucket(id)\r\n    this.createBucket(options)\r\n  }\r\n\r\n  recolorBucket(id, color) {\r\n    if (!this._buckets[id]) {\r\n      return\r\n    }\r\n\r\n    this._buckets[id].updateColor(color)\r\n\r\n    this.$set(this.data[id], 'color', color)\r\n  }\r\n\r\n  reloadBucketSerie(id, type?: string) {\r\n    if (!this._buckets[id]) {\r\n      return\r\n    }\r\n\r\n    if (type) {\r\n      // set different serie type\r\n      this._buckets[id].type = type\r\n    }\r\n\r\n    this._buckets[id].removeIndicator(this._chart)\r\n    this._buckets[id].createSerie(this._chart)\r\n  }\r\n\r\n  createBucket(statBucket) {\r\n    if (statBucket.enabled && typeof this.data[statBucket.id] === 'undefined') {\r\n      const bucket = new Bucket(statBucket.input, statBucket, this.paneId)\r\n\r\n      if (this._chart) {\r\n        bucket.createSerie(this._chart)\r\n      }\r\n\r\n      this._buckets[statBucket.id] = bucket\r\n\r\n      this.$set(this.data, bucket.id, {\r\n        value: 0,\r\n        name: bucket.name,\r\n        color: bucket.color\r\n      })\r\n    }\r\n  }\r\n\r\n  refreshBucketName({ id, name }: { id: string; name: string }) {\r\n    const bucket = this._buckets[id]\r\n    bucket.name = name\r\n    this.$set(this.data[id], 'name', name)\r\n  }\r\n\r\n  editStat(id) {\r\n    dialogService.open(StatDialog, { paneId: this.paneId, bucketId: id })\r\n  }\r\n\r\n  onResize() {\r\n    this.refreshChartDimensions()\r\n  }\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--14-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Stats.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--14-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Stats.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Stats.vue?vue&type=template&id=b3a3024a&\"\nimport script from \"./Stats.vue?vue&type=script&lang=ts&\"\nexport * from \"./Stats.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Stats.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}